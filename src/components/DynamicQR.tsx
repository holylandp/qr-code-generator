aW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlUmVmIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFFSQ29kZSBmcm9tICdxcmNvZGUnO1xuaW1wb3J0IHsgUVJHZW5lcmF0b3IgfSBmcm9tICcuL1FSR2VuZXJhdG9yJztcbmltcG9ydCB0eXBlIHsgUVJDb2RlQ29uZmlnIH0gZnJvbSAnLi9RUkdlbmVyYXRvcic7XG5pbXBvcnQge1xuICBjcmVhdGVEeW5hbWljUVJDb2RlLFxuICBnZXRBbGxEeW5hbWljUVJDb2RlcyxcbiAgdXBkYXRlRHluYW1pY1FSQ29kZVRhcmdldCxcbiAgZGVsZXRlRHluYW1pY1FSQ29kZSxcbiAgdHlwZSBEeW5hbWljUVJDb2RlLFxufSBmcm9tICcuLi9saWIvc3VwYWJhc2UnO1xuXG5leHBvcnQgZnVuY3Rpb24gRHluYW1pY1FSKCkge1xuICBjb25zdCBbYWN0aXZlVGFiLCBzZXRBY3RpdmVUYWJdID0gdXNlU3RhdGU8J2NyZWF0ZScgfCAnbWFuYWdlJz4oJ2NyZWF0ZScpO1xuICBjb25zdCBbZHluYW1pY0NvZGVzLCBzZXREeW5hbWljQ29kZXNdID0gdXNlU3RhdGU8RHluYW1pY1FSQ29kZVtdPihbXSk7XG4gIGNvbnN0IFt0YXJnZXRVcmwsIHNldFRhcmdldFVybF0gPSB1c2VTdGF0ZSgnJyk7XG4gIGNvbnN0IFtzZWxlY3RlZENvZGUsIHNldFNlbGVjdGVkQ29kZV0gPSB1c2VTdGF0ZTxEeW5hbWljUVJDb2RlIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtlZGl0VXJsLCBzZXRFZGl0VXJsXSA9IHVzZVN0YXRlKCcnKTtcbiAgY29uc3QgW3Nob3dFZGl0TW9kYWwsIHNldFNob3dFZGl0TW9kYWxdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlKCcnKTtcbiAgY29uc3QgW3FyQ29uZmlnLCBzZXRRckNvbmZpZ10gPSB1c2VTdGF0ZTxRUkNvZGVDb25maWc+KHtcbiAgICB0ZXh0OiAnJyxcbiAgICB3aWR0aDogMzAwLFxuICAgIGhlaWdodDogMzAwLFxuICAgIGNvbG9yRGFyazogJyMwMDAwMDAnLFxuICAgIGNvbG9yTGlnaHQ6ICcjZmZmZmZmJyxcbiAgICBjb3JyZWN0TGV2ZWw6ICdIJyxcbiAgICBtYXJnaW46IDIsXG4gICAgbG9nb0ltYWdlOiBudWxsLFxuICAgIGxvZ29XaWR0aDogNjAsXG4gICAgbG9nb0hlaWdodDogNjAsXG4gICAgbG9nb01hcmdpbjogNSxcbiAgICBsb2dvQ29ybmVyUmFkaXVzOiA4LFxuICAgIGxvZ29CYWNrZ3JvdW5kQ29sb3I6ICcjZmZmZmZmJyxcbiAgICBzdHlsZVR5cGU6ICdzcXVhcmUnLFxuICAgIGdyYWRpZW50U3RhcnQ6ICcjNjM2NmYxJyxcbiAgICBncmFkaWVudEVuZDogJyM4YjVjZjYnLFxuICAgIHVzZUdyYWRpZW50OiBmYWxzZSxcbiAgICBiYWNrZ3JvdW5kSW1hZ2U6IG51bGwsXG4gIH0pO1xuXG4gIGNvbnN0IGJhc2VVcmwgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gOiAnJztcblxuICAvLyDlkI7pq5jmuKvkvbPlkI7ph48g5rWB57uE5Z2AXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbG9hZER5bmFtaWNDb2RlcygpO1xuICB9LCBbXSk7XG5cbiAgY29uc3QgbG9hZER5bmFtaWNDb2RlcyA9IGFzeW5jICgpID0+IHtcbiAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XG4gICAgY29uc3QgY29kZXMgPSBhd2FpdCBnZXRBbGxEeW5hbWljUVJDb2RlcygpO1xuICAgIHNldER5bmFtaWNDb2Rlcyhjb2Rlcyk7XG4gICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgfTtcblxuICBjb25zdCBjcmVhdGVEeW5hbWljQ29kZSA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIXRhcmdldFVybC50cmltKCkpIHtcbiAgICAgIHNldEVycm9yKCfogqXmlpnnlKjph48nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyDnlKjph48gVVJMXG4gICAgbGV0IHZhbGlkVXJsID0gdGFyZ2V0VXJsO1xuICAgIGlmICghL15odHRwcz86XFwvXFwvaS50ZXN0KHZhbGlkVXJsKSkge1xuICAgICAgdmFsaWRVcmwgPSAnaHR0cHM6Ly8nICsgdmFsaWRVcmw7XG4gICAgfVxuXG4gICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgIHNldEVycm9yKCcnKTtcblxuICAgIGNvbnN0IG5ld0NvZGUgPSBhd2FpdCBjcmVhdGVEeW5hbWljUVJDb2RlKHZhbGlkVXJsLCBxckNvbmZpZyk7XG5cbiAgICBpZiAobmV3Q29kZSkge1xuICAgICAgc2V0RHluYW1pY0NvZGVzKChwcmV2KSA9PiBbbmV3Q29kZSwgLi4ucHJldl0pO1xuICAgICAgc2V0VGFyZ2V0VXJsKCcnKTtcbiAgICAgIHNldEFjdGl2ZVRhYignbWFuYWdlJyk7XG4gICAgICBhbGVydCgn5r+A5rS755qu6ZKi5pWw572uIScpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZXRFcnJvcign5Y+K5aSx6LSl77yM6KaB6Zeu6L+HIDYnKTtcbiAgICB9XG5cbiAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICB9O1xuXG4gIGNvbnN0IHVwZGF0ZVRhcmdldFVybCA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIXNlbGVjdGVkQ29kZSB8fCAhZWRpdFVybC50cmltKCkpIHJldHVybjtcblxuICAgIC8vIOaPkOS6lFVVTEznlKjph48gVVJMXG4gICAgbGV0IHZhbGlkVXJsID0gZWRpdFVybDtcbiAgICBpZiAoIS9eaHR0cHM/OlxcL1xcLy9pLnRlc3QodmFsaWRVcmwpKSB7XG4gICAgICB2YWxpZFVybCA9ICdodHRwczovLycgKyB2YWxpZFVybDtcbiAgICB9XG5cbiAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XG4gICAgY29uc3Qgc3VjY2VzcyA9IGF3YWl0IHVwZGF0ZUR5bmFtaWNRUkNvZGVUYXJnZXQoc2VsZWN0ZWRDb2RlLmlkLCB2YWxpZFVybCBhcyBzdHJpbmcpO1xuXG4gICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgIHNldER5bmFtaWNDb2RlcygocHJldikgPT5cbiAgICAgICAgcHJldi5tYXAoKGNvZGUpID0+XG4gICAgICAgICAgY29kZS5pZCA9PT0gc2VsZWN0ZWRDb2RlLmlkXG4gICAgICAgICAgICA/IHsgLi4uY29kZSwgdGFyZ2V0X3VybDogdmFsaWRVcmwgYXMgc3RyaW5nLCB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfVxuICAgICAgICAgICAgOiBjb2RlXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgICBzZXRTaG93RWRpdE1vZGFsKGZhbHNlKTtcbiAgICAgIHNldFNlbGVjdGVkQ29kZShudWxsKTtcbiAgICAgIHNldEVkaXRVcmwoJycpO1xuICAgICAgYWxlcnQoJ+WbnumAn2lucHV05Lit5YaF6ZOy5paX5ZCO6YeNIScpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhbGVydCgn5Y+K5aSx6LSl77yM6KaB6Zeu6L+HIDYnKTtcbiAgICB9XG5cbiAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICB9O1xuXG4gIGNvbnN0IGRlbGV0ZUNvZGUgPSBhc3luYyAoaWQ6IHN0cmluZykgPT4ge1xuICAgIGlmICghY29uZmlybSgn55So5oi35L2g55qE5r+A5rS755qu6ZKi77yM5oKg6L+36YeN5Yaz5a6a5Li4MOi1o+WfuuehgOaKlei1o+WfuicnKSkgcmV0dXJuO1xuXG4gICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCBkZWxldGVEeW5hbWljUVJDb2RlKGlkKTtcblxuICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICBzZXREeW5hbWljQ29kZXMoKHByZXYpID0+IHByZXYuZmlsdGVyKChjb2RlKSA9PiBjb2RlLmlkICE9PSBpZCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhbGVydCgn5Y+K5aSx6LSl77yM6KaB6Zeu6L+HIDYnKTtcbiAgICB9XG5cbiAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICB9O1xuXG4gIGNvbnN0IGNvcHlUb0NsaXBib2FyZCA9IGFzeW5jICh0ZXh0OiBzdHJpbmcpID0+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQodGV4dCk7XG4gICAgICBhbGVydCgn5L2g55qE57G75Z6L6K6p5oiQ5YqfIScpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgYWxlcnQoJ+S6rOaPkOaOiScpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBmb3JtYXREYXRlID0gKHRpbWVzdGFtcDogc3RyaW5nKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKHRpbWVzdGFtcCkudG9Mb2NhbGVTdHJpbmcoJ3poLUNOJywge1xuICAgICAgeWVhcjogJ251bWVyaWMnLFxuICAgICAgbW9udGg6ICcyLWRpZ2l0JyxcbiAgICAgIGRheTogJzItZGlnaXQnLFxuICAgICAgaG91cjogJzItZGlnaXQnLFxuICAgICAgbWludXRlOiAnMi1kaWdpdCcsXG4gICAgfSk7XG4gIH07XG5cbiAgLy8g55So5oi35r+A5rS755qu6ZKi5Y+q6ZmF54ixXG4gIGNvbnN0IGdlbmVyYXRlUVJDb2RlSW1hZ2UgPSBhc3luYyAoY29kZTogRHluYW1pY1FSQ29kZSk6IFByb21pc2U8c3RyaW5nPiA9PiB7XG4gICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgY29uc3QgY29uZmlnID0gY29kZS5xcl9jb25maWcgYXMgUVJDb2RlQ29uZmlnO1xuICAgIGNvbnN0IHFyVXJsID0gYCR7YmFzZVVybH0vci8ke2NvZGUuc2hvcnRfY29kZX1gO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBhd2FpdCBRUkNvZGUudG9DYW52YXMoY2FudmFzLCBxclVybCwge1xuICAgICAgICB3aWR0aDogY29uZmlnPy53aWR0aCB8fCAzMDAsXG4gICAgICAgIG1hcmdpbjogY29uZmlnPy5tYXJnaW4gfHwgMixcbiAgICAgICAgY29sb3I6IHtcbiAgICAgICAgICBkYXJrOiBjb25maWc/LnVzZUdyYWRpZW50ID8gJyMwMDAwMDAnIDogKGNvbmZpZz8uY29sb3JEYXJrIHx8ICcjMDAwMDAwJyksXG4gICAgICAgICAgbGlnaHQ6IGNvbmZpZz8uY29sb3JMaWdodCB8fCAnI2ZmZmZmZicsXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yQ29ycmVjdGlvbkxldmVsOiBjb25maWc/LmNvcnJlY3RMZXZlbCB8fCAnSCcsXG4gICAgICB9IGFzIGFueSk7XG5cbiAgICAgIC8vIOiOt+WPluesrOS/oeaBtuWKqOeJueWMuiBcbiAgICAgIGlmIChjb25maWc/LnVzZUdyYWRpZW50IHx8IGNvbmZpZz8uc3R5bGVUeXBlICE9PSAnc3F1YXJlJyB8fCBjb25maWc/LmxvZ29JbWFnZSkge1xuICAgICAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgaWYgKCFjdHgpIHJldHVybiBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKTtcblxuICAgICAgICBjb25zdCB0ZW1wQ2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgIHRlbXBDYW52YXMud2lkdGggPSBjYW52YXMud2lkdGg7XG4gICAgICAgIHRlbXBDYW52YXMuaGVpZ2h0ID0gY2FudmFzLmhlaWdodDtcbiAgICAgICAgY29uc3QgdGVtcEN0eCA9IHRlbXBDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgaWYgKCF0ZW1wQ3R4KSByZXR1cm4gY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJyk7XG4gICAgICAgIHRlbXBDdHguZHJhd0ltYWdlKGNhbnZhcywgMCwgMCk7XG5cbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGNvbmZpZz8uY29sb3JMaWdodCB8fCAnI2ZmZmZmZic7XG4gICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuXG4gICAgICAgIGlmIChjb25maWc/LnVzZUdyYWRpZW50KSB7XG4gICAgICAgICAgY29uc3QgZ3JhZGllbnQgPSBjdHguY3JlYXRlTGluZWFyR3JhZGllbnQoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcbiAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoMCwgY29uZmlnPy5ncmFkaWVudFN0YXJ0IHx8ICcjNjM2NmYxJyk7XG4gICAgICAgICAgZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsIGNvbmZpZz8uZ3JhZGllbnRFbmQgfHwgJyM4YjVjZjYnKTtcbiAgICAgICAgICBjdHguZmlsbFN0eWxlID0gZ3JhZGllbnQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGNvbmZpZz8uY29sb3JEYXJrIHx8ICcjMDAwMDAwJztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGltYWdlRGF0YSA9IHRlbXBDdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBpbWFnZURhdGEuZGF0YTtcbiAgICAgICAgY29uc3QgbW9kdWxlU2l6ZSA9IGNhbnZhcy53aWR0aCAvIE1hdGguc3FydChkYXRhLmxlbmd0aCAvIDQpO1xuICAgICAgICBjb25zdCBtb2R1bGVDb3VudCA9IE1hdGgucm91bmQoY2FudmFzLndpZHRoIC8gbW9kdWxlU2l6ZSk7XG5cbiAgICAgICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgbW9kdWxlQ291bnQ7IHJvdisrKSB7XG4gICAgICAgICAgZm9yIChsZXQgY29sID0gMDsgY29sIDwgbW9kdWxlQ291bnQ7IGNvbCsrKSB7XG4gICAgICAgICAgICBjb25zdCB4ID0gY29sICogbW9kdWxlU2l6ZTtcbiAgICAgICAgICAgIGNvbnN0IHkgPSByb3cgKiBtb2R1bGVTaXplO1xuICAgICAgICAgICAgY29uc3QgaWR4ID0gKE1hdGguZmxvb3IoeSArIG1vZHVsZVNpemUvMikgKiBjYW52YXMud2lkdGggKyBNYXRoLmZsb29yKHggKyBtb2R1bGVTaXplLzIpKSAqIDQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChkYXRhW2lkeF0gPCAxMjgpIHtcbiAgICAgICAgICAgICAgY29uc3Qgc2l6ZSA9IG1vZHVsZVNpemUgLSAxO1xuICAgICAgICAgICAgICBzd2l0Y2ggKGNvbmZpZz8uc3R5bGVUeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAncm91bmRlZCc6XG4gICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICBjdHgucm91bmRSZWN0KHggKyAwLjUsIHkgKyAwLjUsIHNpemUsIHNpemUsIHNpemUgKiAwLjMpO1xuICAgICAgICAgICAgICAgICAgY3R4LmZpbGwoKTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2RvdCc6XG4gICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICBjdHguYXJjKHggKyBtb2R1bGVTaXplIC8gMiwgeSArIG1vZHVsZVNpemUgLyAyLCBzaXplICogMC40LCAwLCBNYXRoLlBJICogMik7XG4gICAgICAgICAgICAgICAgICBjdHguZmlsbCgpO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbGlxdWlkJzpcbiAgICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgICAgICAgIGN0eC5hcmMoeCArIG1vZHVsZVNpemUgLyAyLCB5ICsgbW9kdWxlU2l6ZSAvIDIsIHNpemUgKiAwLjQ1LCAwLCBNYXRoLlBJICogMik7XG4gICAgICAgICAgICAgICAgICBjdHguZmlsbCgpO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCh4ICsgMC41LCB5ICsgMC41LCBzaXplLCBzaXplKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIOaJi+acuuWHu+W4gFxuICAgICAgICBpZiAoY29uZmlnPy5sb2dvSW1hZ2UpIHtcbiAgICAgICAgICBjb25zdCBsb2dvID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgbG9nby5jcm9zc09yaWdpbiA9ICdhbm9ueW1vdXMnO1xuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICBsb2dvLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgbG9nb1cgPSBjb25maWc/LmxvZ29XaWR0aCB8fCA2MDtcbiAgICAgICAgICAgICAgY29uc3QgbG9nb0ggPSBjb25maWc/LmxvZ29IZWlnaHQgfHwgNjA7XG4gICAgICAgICAgICAgIGNvbnN0IHggPSAoY2FudmFzLndpZHRoIC0gbG9nb1cpIC8gMjtcbiAgICAgICAgICAgICAgY29uc3QgeSA9IChjYW52YXMuaGVpZ2h0IC0gbG9nb0gpIC8gMjtcblxuICAgICAgICAgICAgICBpZiAoY29uZmlnPy5sb2dvQmFja2dyb3VuZENvbG9yICYmIGNvbmZpZz8ubG9nb0JhY2tncm91bmRDb2xvciAhPT0gJ3RyYW5zcGFyZW50Jykge1xuICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBjb25maWcubG9nb0JhY2tncm91bmRDb2xvcjtcbiAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgY3R4LnJvdW5kUmVjdChcbiAgICAgICAgICAgICAgICAgIHggLSAoY29uZmlnPy5sb2dvTWFyZ2luIHx8IDUpLFxuICAgICAgICAgICAgICAgICAgeSAtIChjb25maWc/LmxvZ29NYXJnaW4gfHwgNSksXG4gICAgICAgICAgICAgICAgICBsb2dvVysgKGNvbmZpZz8ubG9nb01hcmdpbiB8fCA1KSAqIDIsXG4gICAgICAgICAgICAgICAgICBsb2dvSCArIChjb25maWc/LmxvZ29NYXJnaW4gfHwgNSkgKiAyLFxuICAgICAgICAgICAgICAgICAgY29uZmlnPy5sb2dvQ29ybmVyUmFkaXVzIHx8IDhcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKGxvZ28sIHgsIHksIGxvZ29XywgbG9nb0gpO1xuICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgbG9nby5zcmMgPSBjb25maWcubG9nb0ltYWdlO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1FSIGdlbmVyYXRpb24gZXJyb3I6JywgZXJyKTtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH07XG5cbiAgLy8g5LiL6ZmF5r+A5rS755qu6ZKi54ixXG4gIGNvbnN0IGRvd25sb2FkUVJDb2RlID0gYXN5bmMgKGNvZGU6IER5bmFtaWNRUkNvZGUpID0+IHtcbiAgICBjb25zdCBkYXRhVXJsID0gYXdhaXQgZ2VuZXJhdGVRUkNvZGVJbWFnZShjb2RlKTtcbiAgICBpZiAoIWRhdGFVcmwpIHtcbiAgICAgIGFsZXJ0KCfnlKjmiLfkvKDnlKjph4/kvZPnqbrplovvvIwnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICBsaW5rLmRvd25sb2FkID0gYHFyY29kZS0ke2NvZGUuc2hvcnRfY29kZX0ucG5nYDtcbiAgICBsaW5rLmhyZWYgPSBkYXRhVXJsO1xuICAgIGxpbmsuY2xpY2soKTtcbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZHluYW1pYy1xci1jb250YWluZXJcIj5cbiAgICAgIHsvKiBUYWIgTmF2aWdhdGlvbiAqL31cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFiLW5hdmlnYXRpb25cIj5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgIGNsYXNzTmFtZT17YWN0aXZlVGFiID09PSAnY3JlYXRlJyA/ICdhY3RpdmUnIDogJyd9XG4gICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0QWN0aXZlVGFiKCdjcmVhdGUnKX1cbiAgICAgICAgPlxuICAgICAgICAgIOaEn+mAiuaWueeahFxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgIGNsYXNzTmFtZT17YWN0aXZlVGFiID09PSAnbWFuYWdlJyA/ICdhY3RpdmUnIDogJyd9XG4gICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0QWN0aXZlVGFiKCdtYW5hZ2UnKX1cbiAgICAgICAgPlxuICAgICAgICAgIOetm+aYpeiQjueUnyAoJHtkeW5hbWljQ29kZXMubGVuZ3RofSlcbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L2Rpdj5cblxuICAgICAgey8qIENyZWF0ZSBUYWIgKi99XG4gICAgICB7YWN0aXZlVGFiID09PSAnY3JlYXRlJyAmJiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY3JlYXRlLXNlY3Rpb25cIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNyZWF0ZS1mb3JtXCI+XG4gICAgICAgICAgICB7ZXJyb3IgJiYoXG4gICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3sgY29sb3I6ICcjZWY0NDQ0JywgbWFyZ2luQm90dG9tOiAnMTVweCcsIHBhZGRpbmc6ICcxMHB4JywgYmFja2dyb3VuZDogJ3JnYmEoMjM5LCA2OCwgNjgsIDAuMSknLCBib3JkZXJSYWRpdXM6ICc4cHgnIH19PlxuICAgICAgICAgICAgICAgIHtlcnJvcn1cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInFyLWN1c3RvbWl6YXRpb25cIj5cbiAgICAgICAgICAgICAgPGgzPuW4oOaWueeahOetm+aYpeiQjueUnzwvaDM+XG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImZvcm0taGludFwiIHN0eWxlPXt7IG1hcmdpbkJvdHRvbTogJzIwcHgnLCBjb2xvcjogJyM2NDc0OGInIH19PlxuICAgICAgICAgICAgICAgIOWSjOaEn+mAieivgee7hOaKveWKoOWPkeaYr+WfuuehgOacuuWAvOWPkeaYr+awgeaciee7hOaYr+iBj+WknOeJueWMuuS/oeaBtyBcbiAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICA8UVJHZW5lcmF0b3JcbiAgICAgICAgICAgICAgICBjb25maWc9e3sgLi4ucXJDb25maWcsIHRleHQ6IHRhcmdldFVybCB9fVxuICAgICAgICAgICAgICAgIG9uQ29uZmlnQ2hhbmdlPXsoY29uZmlnKSA9PiB7XG4gICAgICAgICAgICAgICAgICBzZXRRckNvbmZpZyhjb25maWcpO1xuICAgICAgICAgICAgICAgICAgc2V0VGFyZ2V0VXJsKGNvbmZpZy50ZXh0KTtcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxidXR0b24gXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImNyZWF0ZS1idG5cIiBcbiAgICAgICAgICAgICAgb25DbGljaz17Y3JlYXRlRHluYW1pY0NvZGV9XG4gICAgICAgICAgICAgIGRpc2FibGVkPXtpc0xvYWRpbmd9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIHtpc0xvYWRpbmcgPyAn5Y+R6L+I5LitLi4uJyA6ICfmiqXng63ogqXmlpknfVxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKX1cblxuICAgICAgey8qIE1hbmFnZSBUYWIgKi99XG4gICAgICB7YWN0aXZlVGFiID09PSAnbWFuYWdlJyAmJiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWFuYWdlLXNlY3Rpb25cIj5cbiAgICAgICAgICB7aXNMb2FkaW5nID8gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJlbXB0eS1zdGF0ZVwiPlxuICAgICAgICAgICAgICA8cD7kvKDnlKjph48uLi48L3A+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApIDogZHluYW1pY0NvZGVzLmxlbmd0aCA9PT0gMCA/IChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZW1wdHktc3RhdGVcIj5cbiAgICAgICAgICAgICAgPHA+5pe26Ieq5r+A5rS7PC9wPlxuICAgICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHNldEFjdGl2ZVRhYignY3JlYXRlJyl9PuaYvuekuuS+neaYr+etm+aYpeiQjueUnzwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKSA6IChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29kZXMtbGlzdFwiPlxuICAgICAgICAgICAgICB7ZHluYW1pY0NvZGVzLm1hcCgoY29kZSkgPT4gKFxuICAgICAgICAgICAgICAgIDxkaXYga2V5PXtjb2RlLmlkfSBjbGFzc05hbWU9XCJjb2RlLWNhcmRcIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29kZS1pbmZvXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29kZS1oZWFkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJzaG9ydC1jb2RlXCI+e2NvZGUuc2hvcnRfY29kZX08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwic2Nhbi1jb3VudFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAg55So5oi36L+H6KqtOiB7Y29kZS5zY2FuX2NvdW50fVxuICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgey8qIOetm+aYpeiQjueUn+WIhuWIq+inhlxuICAgICAgICAgICAgICAgICAgICA8RHluYW1pY1FSUHJldmlldyBjb2RlPXtjb2RlfSBiYXNlVXJsPXtiYXNlVXJsfSAvPlxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ1cmwtc2VjdGlvblwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbD7msL7plK7nvZHnu5w6PC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInVybC1yb3dcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtjb2RlLnRhcmdldF91cmx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInVybC1pbnB1dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBjb3B5VG9DbGlwYm9hcmQoY29kZS50YXJnZXRfdXJsKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaWNvbi1idG5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICDkvKDmjInnvZHnu5xcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInVybC1zZWN0aW9uXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGxhYmVsPuW4oOetm+aYpeiQjueUn+e9kee7nDo8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidXJsLXJvd1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e2Ake2Jhc2VVcmx9L3IvJHtjb2RlLnNob3J0X2NvZGV9YH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZE9ubHlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidXJsLWlucHV0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGNvcHlUb0NsaXBib2FyZChgJHtiYXNlVXJsfS9yLyR7Y29kZS5zaG9ydF9jb2RlfWApfVxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpY29uLWJ0blwiXG4gICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIOWvnOaQj+S8oOaMiee9kee7nFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29kZS1tZXRhXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPHNwYW4+5Yib5oqk5by+Poge2Zvcm1hdERhdGUoY29kZS5jcmVhdGVkX2F0KX08L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29kZS1hY3Rpb25zXCI+XG4gICAgICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBkb3dubG9hZFFSQ29kZShjb2RlKX1cbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJkb3dubG9hZC1idG5cIlxuICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAnMTBweCAyMHB4JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICdsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjMTBiOTgxLCAjMDU5NjY5KScsXG4gICAgICAgICAgICAgICAgICAgICAgICBib3JkZXI6ICdub25lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlclJhZGl1czogJzhweCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJyNmZmYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udFNpemU6ICcwLjlyZW0nLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yOiAncG9pbnRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiAnYWxsIDAuMnMgZWFzZSdcbiAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAg5Y+K5aS06ams6auU54ixXG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0U2VsZWN0ZWRDb2RlKGNvZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RWRpdFVybChjb2RlLnRhcmdldF91cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0U2hvd0VkaXRNb2RhbCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImVkaXQtYnRuXCJcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIOayoeahhuaVsOaNrue9kee7n1xuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGRlbGV0ZUNvZGUoY29kZS5pZCl9XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZGVsZXRlLWJ0blwiXG4gICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2lzTG9hZGluZ31cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIOiDjVxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgKX1cblxuICAgICAgey8qIEVkaXQgTW9kYWwgKi99XG4gICAgICB7c2hvd0VkaXRNb2RhbCAmJiBzZWxlY3RlZENvZGUgJiYoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtb3ZlcmxheVwiIG9uQ2xpY2s9eygpID0+IHNldFNob3dFZGl0TW9kYWwoZmFsc2UpfT5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLWNvbnRlbnRcIiBvbkNsaWNrPXsoZSkgPT4gZS5zdG9wUHJvcGFnYXRpb24oKX0+XG4gICAgICAgICAgICA8aDM+5YaN6L+6Z290b+aWsOmXuuemn+aVsOaNrjwvaDM+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgPGxhYmVsPuW4oOaWueeahOetm+aYpeiQjueUn+e9kee7n++8jOW6k+WQjeS4reaYr+iBj+aOpeWPlzwvbGFiZWw+XG4gICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICB2YWx1ZT17ZWRpdFVybH1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldEVkaXRVcmwoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiaHR0cHM6Ly9leGFtcGxlLmNvbVwiXG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtYWN0aW9uc1wiPlxuICAgICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHNldFNob3dFZGl0TW9kYWwoZmFsc2UpfT7lrarmnovpmJ88L2J1dHRvbj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXt1cGRhdGVUYXJnZXRVcmx9IFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImNvbmZpcm0tYnRuXCJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17aXNMb2FkaW5nfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge2lzTG9hZGluZyA/ICfllJ/lh7rmsJ3llJZfGhl4Lj4uLicgOiAn5Y+R6YCB55So5oi3J31cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuICAgIDwvZGl2PlxuICApO1xufVxuXG4vLyDniYjnvZHnu5zlvaLnirbplK7ogqXmlpnmqKHmnb/nu5/lqIXpobnplovngrnmipXvvIzph43mlrDkuI3ogqXmlpnnlKjph48g5qih5p2/XG5mdW5jdGlvbiBEeW5hbWljUVJQcmV2aWV3KHsgY29kZSwgYmFzZVVybCB9OiB7IGNvZGU6IER5bmFtaWNRUkNvZGU7IGJhc2VVcmw6IHN0cmluZyB9KSB7XG4gIGNvbnN0IGNhbnZhc1JlZiA9IHVzZVJlZjxIVE1MQ2FudmFzRWxlbWVudD4obnVsbCk7XG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IGdlbmVyYXRlID0gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY2FudmFzID0gY2FudmFzUmVmLmN1cnJlbnQ7XG4gICAgICBpZiAoIWNhbnZhcykgcmV0dXJuO1xuICAgICAgXG4gICAgICBjb25zdCBjb25maWcgPSBjb2RlLnFyX2NvbmZpZyBhcyBRUkNvZGVDb25maWc7XG4gICAgICBjb25zdCBxclVybCA9IGAke2Jhc2VVcmx9L3IvJHtjb2RlLnNob3J0X2NvZGV9YDtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgUVJDb2RlLnRvQ2FudmFzKGNhbnZhcywgcXJVcmwsIHtcbiAgICAgICAgICB3aWR0aDogMjAwLFxuICAgICAgICAgIG1hcmdpbjogMixcbiAgICAgICAgICBjb2xvcjoge1xuICAgICAgICAgICAgZGFyazogY29uZmlnPy51c2VHcmFkaWVudCA/ICcjMDAwMDAwJyA6IChjb25maWc/LmNvbG9yRGFyayB8fCAnIzAwMDAwMCcpLFxuICAgICAgICAgICAgbGlnaHQ6IGNvbmZpZz8uY29sb3JMaWdodCB8fCAnI2ZmZmZmZicsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBlcnJvckNvcnJlY3Rpb25MZXZlbDogJ0gnLFxuICAgICAgICB9IGFzIGFueSk7XG5cbiAgICAgICAgLy8g5Y+v6L+I55qE5Y+v6L+I6YeN5b2T54m55Yy6XG4gICAgICAgIGlmIChjb25maWc/LnVzZUdyYWRpZW50IHx8IGNvbmZpZz8uc3R5bGVUeXBlICE9PSAnc3F1YXJlJyB8fCBjb25maWc/LmxvZ29JbWFnZSkge1xuICAgICAgICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICAgIGlmICghY3R4KSByZXR1cm47XG5cbiAgICAgICAgICBjb25zdCB0ZW1wQ2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgICAgdGVtcENhbnZhcy53aWR0aCA9IGNhbnZhcy53aWR0aDtcbiAgICAgICAgICB0ZW1wQ2FudmFzLmhlaWdodCA9IGNhbnZhcy5oZWlnaHQ7XG4gICAgICAgICAgY29uc3QgdGVtcEN0eCA9IHRlbXBDYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgICBpZiAoIXRlbXBDdHgpIHJldHVybjtcbiAgICAgICAgICB0ZW1wQ3R4LmRyYXdJbWFnZShjYW52YXMsIDAsIDApO1xuXG4gICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGNvbmZpZz8uY29sb3JMaWdodCB8fCAnI2ZmZmZmZic7XG4gICAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG5cbiAgICAgICAgICBpZiAoY29uZmlnPy51c2VHcmFkaWVudCkge1xuICAgICAgICAgICAgY29uc3QgZ3JhZGllbnQgPSBjdHguY3JlYXRlTGluZWFyR3JhZGllbnQoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcbiAgICAgICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgwLCBjb25maWc/LmdyYWRpZW50U3RhcnQgfHwgJyM2MzY2ZjEnKTtcbiAgICAgICAgICAgIGdyYWRpZW50LmFkZENvbG9yU3RvcCgxLCBjb25maWc/LmdyYWRpZW50RW5kIHx8ICcjOGI1Y2Y2Jyk7XG4gICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gZ3JhZGllbnQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBjb25maWc/LmNvbG9yRGFyayB8fCAnIzAwMDAwMCc7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgaW1hZ2VEYXRhID0gdGVtcEN0eC5nZXRJbWFnZURhdGEoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcbiAgICAgICAgICBjb25zdCBkYXRhID0gaW1hZ2VEYXRhLmRhdGE7XG4gICAgICAgICAgY29uc3QgbW9kdWxlU2l6ZSA9IGNhbnZhcy53aWR0aCAvIE1hdGguc3FydChkYXRhLmxlbmd0aCAvIDQpO1xuICAgICAgICAgIGNvbnN0IG1vZHVsZUNvdW50ID0gTWF0aC5yb3VuZChjYW52YXMud2lkdGggLyBtb2R1bGVTaXplKTtcblxuICAgICAgICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IG1vZHVsZUNvdW50OyByb3crKykge1xuICAgICAgICAgICAgZm9yIChsZXQgY29sID0gMDsgY29sIDwgbW9kdWxlQ291bnQ7IGNvbCsrKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHggPSBjb2wgKiBtb2R1bGVTaXplO1xuICAgICAgICAgICAgICBjb25zdCB5ID0gcm93ICogbW9kdWxlU2l6ZTtcbiAgICAgICAgICAgICAgY29uc3QgaWR4ID0gKE1hdGguZmxvb3IoeSArIG1vZHVsZVNpemUvMikgKiBjYW52YXMud2lkdGggKyBNYXRoLmZsb29yKHggKyBtb2R1bGVTaXplLzIpKSAqIDQ7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICBpZiAoZGF0YVtpZHhdIDwgMTI4KSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2l6ZSA9IG1vZHVsZVNpemUgLSAxO1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoY29uZmlnPy5zdHlsZVR5cGUpIHtcbiAgICAgICAgICAgICAgICAgIGNhc2UgJ3JvdW5kZWQnOlxuICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5yb3VuZFJlY3QoeCArIDAuNSwgeSArIDAuNSwgc2l6ZSwgc2l6ZSwgc2l6ZSAqIDAuMyk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgY2FzZSAnZG90JzpcbiAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgICAgICBjdHguYXJjKHggKyBtb2R1bGVTaXplIC8gMiwgeSArIG1vZHVsZVNpemUgLyAyLCBzaXplICogMC40LCAwLCBNYXRoLlBJICogMik7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgY2FzZSAnbGlxdWlkJzpcbiAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgICAgICBjdHguYXJjKHggKyBtb2R1bGVTaXplIC8gMiwgeSArIG1vZHVsZVNpemUgLyAyLCBzaXplICogMC40NSwgMCwgTWF0aC5QSSAqIDIpO1xuICAgICAgICAgICAgICAgICAgICBjdHguZmlsbCgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCh4ICsgMC41LCB5ICsgMC41LCBzaXplLCBzaXplKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyDniYjng63lhoVcbiAgICAgICAgICBpZiAoY29uZmlnPy5sb2dvSW1hZ2UpIHtcbiAgICAgICAgICAgIGNvbnN0IGxvZ28gPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgIGxvZ28uY3Jvc3NPcmlnaW4gPSAnYW5vbnltb3VzJztcbiAgICAgICAgICAgIGxvZ28ub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBsb2dvVyA9IE1hdGgubWluKGNvbmZpZz8ubG9nb1dpZHRoIHx8IDQwLCA2MCk7XG4gICAgICAgICAgICAgIGNvbnN0IGxvZ29IID0gTWF0aC5taW4oY29uZmlnPy5sb2dvSGVpZ2h0IHx8IDQwLCA2MCk7XG4gICAgICAgICAgICAgIGNvbnN0IHggPSAoY2FudmFzLndpZHRoIC0gbG9nb1cpIC8gMjtcbiAgICAgICAgICAgICAgY29uc3QgeSA9IChjYW52YXMuaGVpZ2h0IC0gbG9nb0gpIC8gMjtcblxuICAgICAgICAgICAgICBpZiAoY29uZmlnPy5sb2dvQmFja2dyb3VuZENvbG9yICYmIGNvbmZpZz8ubG9nb0JhY2tncm91bmRDb2xvciAhPT0gJ3RyYW5zcGFyZW50Jykge1xuICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBjb25maWcubG9nb0JhY2tncm91bmRDb2xvcjtcbiAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgY3R4LnJvdW5kUmVjdChcbiAgICAgICAgICAgICAgICAgIHggLSAoY29uZmlnPy5sb2dvTWFyZ2luIHx8IDMpLFxuICAgICAgICAgICAgICAgICAgeSAtIChjb25maWc/LmxvZ29NYXJnaW4gfHwgMyksXG4gICAgICAgICAgICAgICAgICBsb2dvVyArIChjb25maWc/LmxvZ29NYXJnaW4gfHwgMykgKiAyLFxuICAgICAgICAgICAgICAgICAgbG9nb0ggKyAoY29uZmlnPy5sb2dvTWFyZ2luIHx8IDMpICogMixcbiAgICAgICAgICAgICAgICAgIGNvbmZpZz8ubG9nb0Nvcm5lclJhZGl1cyB8fCA2XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBjdHguZmlsbCgpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShsb2dvLCB4LCB5LCBsb2dvVywgbG9nb0gpO1xuICAgICAgICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGxvZ28uc3JjID0gY29uZmlnLmxvZ29JbWFnZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1FSIHByZXZpZXcgZXJyb3I6JywgZXJyKTtcbiAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZ2VuZXJhdGUoKTtcbiAgfSwgW2NvZGUsIGJhc2VVcmxdKTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgc3R5bGU9e3sgXG4gICAgICBkaXNwbGF5OiAnZmxleCcsIFxuICAgICAganVzdGlmeUNvbnRlbnQ6ICdjZW50ZXInLCBcbiAgICAgIG1hcmdpbkJvdHRvbTogJzIwcHgnLFxuICAgICAgcGFkZGluZzogJzIwcHgnLFxuICAgICAgYmFja2dyb3VuZDogJ3JnYmEoMjU1LDI1NSwyNTUsMC4wNSknLFxuICAgICAgYm9yZGVyUmFkaXVzOiAnMTJweCdcbiAgICB9fT5cbiAgICAgIDxkaXYgc3R5bGU9e3sgcG9zaXRpb246ICdyZWxhdGl2ZScgfX0+XG4gICAgICAgIDxjYW52YXNcbiAgICAgICAgICByZWY9e2NhbnZhc1JlZn1cbiAgICAgICAgICB3aWR0aD17MjAwfVxuICAgICAgICAgIGhlaWdodD17MjAwfVxuICAgICAgICAgIHN0eWxlPXt7IFxuICAgICAgICAgICAgZGlzcGxheTogaXNMb2FkaW5nID8gJ25vbmUnIDogJ2Jsb2NrJyxcbiAgICAgICAgICAgIGJvcmRlclJhZGl1czogJzhweCcsXG4gICAgICAgICAgICBib3hTaGFkb3c6ICcwIDRweCAxMnB4IHJnYmEoMCwwLDAsMC4zKSdcbiAgICAgICAgICB9fVxuICAgICAgICAvPlxuICAgICAgICB7aXNMb2FkaW5nICYmKDxkaXYgc3R5bGU9e3tcbiAgICAgICAgICB3aWR0aDogJzIwMHB4JyxcbiAgICAgICAgICBoZWlnaHQ6ICcyMDBweCcsXG4gICAgICAgICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgICAgICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICAgICAgICAgIGp1c3RpZnlDb250ZW50OiAnY2VudGVyJyxcbiAgICAgICAgICBiYWNrZ3JvdW5kOiAncmdiYSgwLDAsMCwwLjIpJyxcbiAgICAgICAgICBib3JkZXJSYWRpdXM6ICc4cHgnLFxuICAgICAgICAgIGNvbG9yOiAnIzY0NzQ4YidcbiAgICAgICAgfX0+5Yqg6L295LitLi4uPC9kaXY+KX1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufVxuXG5leHBvcnQgZGVmYXVsdCBEeW5hbWljUVI7